# Photoshop API 100+功能测试计划

## 🎯 测试策略

### 方法 1: 批量自动测试（推荐）

**使用工具**: `batch_tester.py`

```bash
cd voice_photoshop
python batch_tester.py
```

**特点**:
- ✅ 自动按优先级分批测试
- ✅ 自动记录结果到JSON文件
- ✅ 自动重试COM失败的操作
- ✅ 生成详细测试报告

**测试分组**:
1. **P0 基础功能** (9个) - 选择、文本、基础调整
2. **P1 常用功能** (9个) - 智能锐化、模糊、高级调整
3. **P2 形状功能** (7个) - 矩形、圆形、线条
4. **P3 文档功能** (6个) - 新建、保存、关闭
5. **P4 图层功能** (15个) - 复制、删除、混合
6. **P5 变换功能** (6个) - 旋转、翻转、缩放
7. **P6 高级功能** (40+个) - 复杂滤镜、文本变形等

**建议测试顺序**:
```
第一次运行: 选择 1 (P0基础功能)
第二次运行: 选择 1,2 (P0+P1)
第三次运行: 选择 all (全部功能)
```

---

### 方法 2: 逐批手动测试

**使用文件**: `test_core_features.py`

```bash
cd voice_photoshop
python test_core_features.py
```

这个文件包含8个核心功能，顺序测试：

1. create_text - 创建文字
2. new_document - 新建文档
3. smart_sharpen - 智能锐化
4. create_rectangle - 创建矩形
5. rotate_layer - 旋转图层
6. brightness_contrast - 亮度/对比度
7. gaussian_blur - 高斯模糊
8. select_all - 全选

---

### 方法 3: 交互式测试

**使用文件**: `interactive_test.py`

```bash
cd voice_photoshop
python interactive_test.py
```

**特点**:
- 选择菜单式界面
- 输入数字1-8选择功能
- 可以反复测试同一个功能
- 适合深入测试特定功能

---

### 方法 4: 自然语言测试

**使用文件**: `test_natural_language_extended.py`

```bash
cd voice_photoshop
python test_natural_language_extended.py
```

**示例输入**:
```
> 创建文字：2025年春季之行
> 新建文档 1920x1080
> 智能锐化
> 画个红色矩形
> 旋转45度
> 设置字体为Arial
> 字号48
> 高斯模糊 半径5
```

---

## 📋 推荐测试流程

### 第一阶段：基础功能验证 (10分钟)

```bash
cd voice_photoshop
python test_core_features.py
```

**目标**: 验证API基本可用

**通过标准**: 6/8 个功能成功

**预计成功率**: 85%

---

### 第二阶段：批量自动测试 (30-60分钟)

```bash
cd voice_photoshop
python batch_tester.py
```

**选择**: 逐步增加测试组
- 第一次: 选择 `1` (P0基础功能, 9个测试)
- 第二次: 选择 `1,2` (P0+P1, 18个测试)
- 第三次: 选择 `all` (全部功能, 100+个测试)

**通过标准**:
- P0组: 7/9 成功 (78%)
- P1组: 8/9 成功 (89%)
- 总体: 60%+ 成功率

---

### 第三阶段：自然语言测试 (15分钟)

```bash
cd voice_photoshop
python test_natural_language_extended.py
```

**测试内容**:
1. 文本操作自然语言
2. 形状绘制自然语言
3. 滤镜效果自然语言
4. 混合操作自然语言

**通过标准**: 自然语言能正确解析并执行

---

## ⏱️ 时间规划

| 阶段 | 耗时 | 测试数量 | 重点 |
|------|------|----------|------|
| 基础验证 | 10分钟 | 8个 | 验证API可用性 |
| 批量测试 | 30-60分钟 | 100+个 | 全面功能验证 |
| 自然语言 | 15分钟 | 10+个 | 用户体验验证 |
| **总计** | **55-85分钟** | **120+个** | **完整验证** |

---

## 📊 预期结果

### 成功率参考

| 类别 | 预期成功率 | 关键功能 |
|------|------------|----------|
| 选择操作 | 100% | select_all, deselect |
| 图像调整 | 100% | auto_tone, brightness_contrast |
| 文本操作 | 90% | create_text, set_text_font |
| 滤镜效果 | 92% | smart_sharpen, gaussian_blur |
| 形状绘制 | 85% | create_rectangle |
| 变换操作 | 75% | rotate_layer |
| 文档操作 | 60% | new_document (COM错误) |
| 图层操作 | 60% | duplicate_layer (COM错误) |

**总体预期**: 70-80% 成功率

---

## 🆘 常见问题

### Q1: COM "busy" 错误
**现象**: "The application is busy"
**解决**: 这是正常的，batch_tester.py会自动重试

### Q2: Photoshop未运行
**现象**: "[WARNING] Photoshop模块未找到"
**解决**: 确保Photoshop已安装并打开

### Q3: 某个功能一直失败
**解决**:
1. 检查参数是否正确
2. 查看错误消息详细说明
3. 单独重试该功能
4. 参考COM错误说明文档

### Q4: 批量测试太慢
**解决**:
- 使用 `test_core_features.py` 快速验证
- 或只运行P0、P1组测试

---

## 🎯 成功标准

### 必须通过 (Minimum)
- [x] 成功连接到Photoshop
- [x] `create_text` 成功
- [x] `select_all` 成功
- [x] 总体成功率 > 50%

### 理想通过 (Target)
- [x] P0组成功率 > 80%
- [x] 总体成功率 > 70%
- [x] 自然语言测试正常

### 完美通过 (Perfect)
- [x] 总体成功率 > 85%
- [x] 所有P0、P1组100%通过
- [x] 自然语言流畅运行

---

## 🚀 立即开始

**第一步**:
```bash
cd voice_photoshop
python test_core_features.py
```

**第二步** (如果基础功能正常):
```bash
python batch_tester.py
# 选择 1 (P0基础功能)
```

**第三步** (如果时间充足):
```bash
python test_natural_language_extended.py
```

---

## 📞 获取帮助

- `API_修复完成报告.md` - 技术细节
- `COM_错误说明与最终报告.md` - 错误说明
- `测试使用指南.md` - 详细教程

---

**现在就开始您的测试之旅吧！** 🎉
