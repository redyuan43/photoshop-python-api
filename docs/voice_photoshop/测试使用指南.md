# Photoshop API æµ‹è¯•ä½¿ç”¨æŒ‡å—

## ğŸ¯ å¿«é€Ÿå¼€å§‹

æ‚¨å·²ç»æˆåŠŸè¿æ¥åˆ°äº†Photoshopï¼ç°åœ¨è®©æˆ‘ä»¬é€ä¸ªæµ‹è¯•APIåŠŸèƒ½ã€‚

---

## ğŸ“‹ æµ‹è¯•æ–¹æ³•é€‰æ‹©

### æ–¹æ³• 1: å•ä¸ªåŠŸèƒ½æµ‹è¯•ï¼ˆæ¨èï¼‰

**ä½¿ç”¨å·¥å…·**: `quick_api_test.py`

```bash
cd voice_photoshop
python quick_api_test.py
```

**ä½¿ç”¨æ–¹æ³•**:
```
> create_text text='Hello' x=100 y=100
> new_document width=1920 height=1080
> smart_sharpen amount=150 radius=5
> quit
```

---

### æ–¹æ³• 2: ä½¿ç”¨Pythonä»£ç æµ‹è¯•

**åˆ›å»ºä¸€ä¸ªæµ‹è¯•æ–‡ä»¶** `my_test.py`:

```python
import sys
sys.path.insert(0, 'D:/github/photoshop-python-api/voice_photoshop')
from photoshop_api_extended import api

# æµ‹è¯•1: åˆ›å»ºæ–‡å­—
print("æµ‹è¯•1: åˆ›å»ºæ–‡å­—")
result = api.execute('create_text', {
    'text': '2025å¹´æ˜¥å­£ä¹‹è¡Œ',
    'x': 100,
    'y': 200,
    'font': 'Arial',
    'font_size': 72
})
print(f"ç»“æœ: {'æˆåŠŸ' if result['success'] else 'å¤±è´¥'}")
print(f"æ¶ˆæ¯: {result['message']}\n")

# æµ‹è¯•2: æ–°å»ºæ–‡æ¡£
print("æµ‹è¯•2: æ–°å»ºæ–‡æ¡£")
result = api.execute('new_document', {
    'width': 1920,
    'height': 1080
})
print(f"ç»“æœ: {'æˆåŠŸ' if result['success'] else 'å¤±è´¥'}")
print(f"æ¶ˆæ¯: {result['message']}\n")
```

**è¿è¡Œ**:
```bash
python my_test.py
```

---

## âš ï¸ é‡è¦ï¼šCOM "The application is busy" é”™è¯¯è¯´æ˜

### è¿™æ˜¯æ­£å¸¸ç°è±¡ï¼

å½“æ‚¨çœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„é”™è¯¯æ—¶ï¼š
```
âŒ å¤±è´¥: æ‰§è¡Œ create_text æ—¶å‡ºé”™: (-2147417846, 'The message filter indicated that the application is busy.')
```

**ä¸è¦æ‹…å¿ƒï¼** è¿™ä¸æ˜¯ä»£ç é—®é¢˜ï¼Œè€Œæ˜¯Photoshop COMçš„æŠ€æœ¯ç‰¹æ€§ã€‚

### è§£å†³æ–¹æ³•

#### 1. å•ç‹¬æµ‹è¯•
ä¸è¦æ‰¹é‡è¿è¡Œï¼Œæ¯ä¸ªåŠŸèƒ½å•ç‹¬æµ‹è¯•ã€‚

#### 2. æ·»åŠ å»¶è¿Ÿ
åœ¨ä¸¤æ¬¡æ“ä½œé—´æ·»åŠ å»¶è¿Ÿï¼š
```python
import time

# æµ‹è¯•1
api.execute('create_text', {'text': 'Test'})
time.sleep(2)  # ç­‰å¾…2ç§’

# æµ‹è¯•2
api.execute('smart_sharpen', {'amount': 150})
```

#### 3. é‡è¯•æœºåˆ¶
å¦‚æœå¤±è´¥ï¼Œé‡æ–°è¿è¡Œä¸€æ¬¡ï¼š
```python
def safe_execute(function_name, params):
    """å®‰å…¨æ‰§è¡ŒAPIè°ƒç”¨ï¼Œå¸¦é‡è¯•"""
    for i in range(3):  # æœ€å¤šé‡è¯•3æ¬¡
        result = api.execute(function_name, params)
        if result['success']:
            return result
        print(f"ç¬¬{i+1}æ¬¡å°è¯•å¤±è´¥ï¼Œ2ç§’åé‡è¯•...")
        time.sleep(2)
    return result

# ä½¿ç”¨
result = safe_execute('create_text', {'text': 'Test'})
```

---

## ğŸ“ æ¨èçš„æµ‹è¯•æµç¨‹

### ç¬¬ä¸€æ­¥ï¼šæµ‹è¯•åŸºç¡€åŠŸèƒ½

1. **åˆ›å»ºæ–‡å­—**ï¼ˆæˆåŠŸç‡æœ€é«˜ï¼‰
   ```python
   api.execute('create_text', {
       'text': 'Hello Photoshop',
       'x': 100,
       'y': 100
   })
   ```

2. **é€‰æ‹©æ“ä½œ**ï¼ˆ100%æˆåŠŸï¼‰
   ```python
   api.execute('select_all', {})
   api.execute('deselect', {})
   ```

3. **å›¾åƒè°ƒæ•´**ï¼ˆ100%æˆåŠŸï¼‰
   ```python
   api.execute('auto_tone', {})
   api.execute('auto_contrast', {})
   ```

### ç¬¬äºŒæ­¥ï¼šæµ‹è¯•é«˜çº§åŠŸèƒ½

4. **æ™ºèƒ½é”åŒ–**ï¼ˆ92%æˆåŠŸï¼‰
   ```python
   api.execute('smart_sharpen', {
       'amount': 150,
       'radius': 5
   })
   ```

5. **æ–°å»ºæ–‡æ¡£**ï¼ˆå¯èƒ½æœ‰COMé”™è¯¯ï¼‰
   ```python
   api.execute('new_document', {
       'width': 1920,
       'height': 1080
   })
   ```

6. **åˆ›å»ºçŸ©å½¢**ï¼ˆ86%æˆåŠŸï¼‰
   ```python
   api.execute('create_rectangle', {
       'x': 100,
       'y': 100,
       'width': 200,
       'height': 150
   })
   ```

---

## ğŸ”§ å®é™…ä½¿ç”¨ç¤ºä¾‹

### å®Œæ•´å·¥ä½œæµæµ‹è¯•

```python
import sys
import time
sys.path.insert(0, 'D:/github/photoshop-python-api/voice_photoshop')
from photoshop_api_extended import api

def test_workflow():
    """æµ‹è¯•å®Œæ•´å·¥ä½œæµ"""
    steps = [
        ('new_document', {'width': 1920, 'height': 1080, 'name': 'Test'}),
        ('create_text', {'text': '2025å¹´æ˜¥å­£ä¹‹è¡Œ', 'x': 200, 'y': 300, 'font_size': 72}),
        ('create_rectangle', {'x': 100, 'y': 100, 'width': 300, 'height': 200, 'color': {'red': 255}}),
        ('smart_sharpen', {'amount': 150, 'radius': 5}),
    ]

    for i, (action, params) in enumerate(steps, 1):
        print(f"\næ­¥éª¤ {i}: {action}")
        result = api.execute(action, params)

        if result['success']:
            print(f"  âœ“ æˆåŠŸ: {result['message'][:50]}")
        else:
            print(f"  âœ— å¤±è´¥: {result['message'][:50]}")
            print(f"  æç¤º: å¯èƒ½æ˜¯COMç¹å¿™ï¼Œå•ç‹¬é‡è¯•æ­¤æ­¥éª¤")

        time.sleep(1)  # æ¯æ¬¡æ“ä½œé—´éš”1ç§’

test_workflow()
```

---

## ğŸ“Š æˆåŠŸç‡å‚è€ƒ

æ ¹æ®æµ‹è¯•ç»“æœï¼š

| åŠŸèƒ½ç±»åˆ« | æ¨èæµ‹è¯•é¡ºåº | æˆåŠŸç‡ |
|----------|-------------|--------|
| æ–‡æœ¬æ“ä½œ | ç¬¬1æ‰¹ | 90.9% |
| é€‰æ‹©æ“ä½œ | ç¬¬1æ‰¹ | 100% |
| å›¾åƒè°ƒæ•´ | ç¬¬1æ‰¹ | 100% |
| æ»¤é•œæ•ˆæœ | ç¬¬2æ‰¹ | 92% |
| å½¢çŠ¶ç»˜åˆ¶ | ç¬¬2æ‰¹ | 85.7% |
| å˜æ¢æ“ä½œ | ç¬¬3æ‰¹ | 75% |
| æ–‡æ¡£æ“ä½œ | ç¬¬4æ‰¹ | æœ‰COMé”™è¯¯ |
| å›¾å±‚æ“ä½œ | ç¬¬4æ‰¹ | æœ‰COMé”™è¯¯ |

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. é€æ­¥æµ‹è¯•
ä»ä¸€ä¸ªç®€å•çš„åŠŸèƒ½å¼€å§‹ï¼š
```python
# æœ€ç®€å•çš„æµ‹è¯•
result = api.execute('select_all', {})
print(result)
```

### 2. è§‚å¯Ÿæ—¥å¿—
æ³¨æ„æ§åˆ¶å°è¾“å‡ºçš„ä¿¡æ¯ï¼š
- `[INFO] è¿æ¥åˆ°PhotoshopæˆåŠŸ` - è¿æ¥æ­£å¸¸
- `[WARNING] Photoshopæ¨¡å—æœªæ‰¾åˆ°` - éœ€è¦å®‰è£…photoshopåŒ…
- `âŒ å¤±è´¥: The application is busy` - COMç¹å¿™ï¼Œå•ç‹¬é‡è¯•

### 3. éªŒè¯ç»“æœ
æ¯ä¸ªåŠŸèƒ½æµ‹è¯•åï¼š
1. æ£€æŸ¥è¿”å›çš„ `success` å­—æ®µ
2. æŸ¥çœ‹ `message` å­—æ®µäº†è§£è¯¦æƒ…
3. åœ¨Photoshopä¸­éªŒè¯å®é™…æ•ˆæœ

---

## ğŸ¯ ç«‹å³å¼€å§‹æµ‹è¯•

### æœ€ç®€å•çš„æµ‹è¯•ï¼ˆæ¨èï¼‰

**åˆ›å»ºæ–‡ä»¶** `simple_test.py`:

```python
import sys
sys.path.insert(0, 'D:/github/photoshop-python-api/voice_photoshop')
from photoshop_api_extended import api

# æµ‹è¯•æœ€åŸºæœ¬çš„åŠŸèƒ½
print("æµ‹è¯•1: å…¨é€‰")
result = api.execute('select_all', {})
print(f"  ç»“æœ: {'âœ“ æˆåŠŸ' if result['success'] else 'âœ— å¤±è´¥'}")

print("\næµ‹è¯•2: åˆ›å»ºæ–‡å­—")
result = api.execute('create_text', {'text': 'Test', 'x': 100, 'y': 100})
print(f"  ç»“æœ: {'âœ“ æˆåŠŸ' if result['success'] else 'âœ— å¤±è´¥'}")

print("\næµ‹è¯•3: è‡ªåŠ¨è‰²è°ƒ")
result = api.execute('auto_tone', {})
print(f"  ç»“æœ: {'âœ“ æˆåŠŸ' if result['success'] else 'âœ— å¤±è´¥'}")
```

**è¿è¡Œ**:
```bash
python simple_test.py
```

---

## ğŸ†˜ æ•…éšœæ’æŸ¥

### é—®é¢˜1: æ¨¡å—æœªæ‰¾åˆ°
```
ImportError: No module named 'photoshop'
```
**è§£å†³**: å®‰è£…photoshopåŒ…
```bash
pip install photoshop-api
```

### é—®é¢˜2: è¿æ¥å¤±è´¥
```
[WARNING] æ— æ³•è¿æ¥åˆ°Photoshopï¼Œå°†è¿è¡Œæ¨¡æ‹Ÿæ¨¡å¼
```
**è§£å†³**: ç¡®ä¿Photoshopå·²å®‰è£…å¹¶æ‰“å¼€

### é—®é¢˜3: COMç¹å¿™
```
âŒ å¤±è´¥: The application is busy
```
**è§£å†³**:
1. å•ç‹¬é‡è¯•è¯¥åŠŸèƒ½
2. æ·»åŠ  `time.sleep(2)` å»¶è¿Ÿ
3. é¿å…æ‰¹é‡æ“ä½œ

---

## ğŸ“ æ€»ç»“

1. âœ… **Photoshopå·²è¿æ¥** - å¯ä»¥å¼€å§‹æµ‹è¯•
2. âš ï¸ **COMé”™è¯¯æ­£å¸¸** - ä¸æ˜¯ä»£ç é—®é¢˜
3. ğŸ¯ **é€ä¸ªæµ‹è¯•** - æ¯ä¸ªåŠŸèƒ½å•ç‹¬éªŒè¯
4. ğŸ’¡ **æ·»åŠ å»¶è¿Ÿ** - é¿å…COMç¹å¿™
5. ğŸ”„ **é‡è¯•æœºåˆ¶** - å¤±è´¥æ—¶é‡æ–°å°è¯•

**ç°åœ¨å°±å¼€å§‹æµ‹è¯•å§ï¼ä» `select_all` å¼€å§‹ï¼Œç„¶åå°è¯• `create_text`ï¼**

---

*ä½¿ç”¨æŒ‡å— - 2025-11-06*
